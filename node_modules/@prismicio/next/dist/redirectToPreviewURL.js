import { redirect } from "next/navigation";
import { draftMode, cookies } from "next/headers";
import { preview } from './_node_modules/@prismicio/client/dist/cookie.js';
async function redirectToPreviewURL(config) {
  const basePath = config.basePath || "";
  const request = "request" in config ? config.request : config.req;
  config.client.enableAutoPreviewsFromReq(request);
  const previewUrl = await config.client.resolvePreviewURL({
    linkResolver: config.linkResolver,
    defaultURL: config.defaultURL || "/"
  });
  if ("nextUrl" in request) {
    draftMode().enable();
    const previewCookie = request.nextUrl.searchParams.get("token");
    if (previewCookie) {
      cookies().set(preview, previewCookie);
    }
    redirect(basePath + previewUrl);
  } else {
    if (!("res" in config)) {
      throw new Error("[redirectToPreviewURL] The `res` object from the API route must be provided to `redirectToPreviewURL()`.");
    }
    config.res.redirect(basePath + previewUrl);
    return;
  }
}
export {
  redirectToPreviewURL
};
//# sourceMappingURL=redirectToPreviewURL.js.map
